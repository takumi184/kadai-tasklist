<header>
  <nav>
    <div>
      <a href="/">Tasklist</a>
      <button type="button">
        <span></span>
      </button>

      <div>
        <ul>
          <li><%= link_to 'Signup', signup_path, class: 'nav-link' %></li>
          <li><a href="#">Login</a></li>
        </ul>
      </div>
    </div>
  </nav>
</header>
<h1>タスク一覧</h1>

<ul>
  <% @tasks.each do |message| %>
    <li><%= link_to message.id, message %> : <%= message.status %> &gt; <%= message.content %></li>
  <% end %>
</ul>

<%= link_to '新規タスクの投稿', new_task_path %>
<%= render 'tasks', users: @tasks %>


<% if logged_in? %>
  <p>ログイン完了ユーザ: <%= current_user.name %></p>
<% else %>
  <div class="bg-secondary p-3 p-sm-5 my-4 rounded">
    <div class="text-center text-white">
      <h1>Welcome to the Tasklist</h1>
      <%= link_to 'Sign up now!', signup_path, class: 'btn btn-lg btn-primary' %>
    </div>
  </div>
<% end %>


<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
  <% if logged_in? %>
    <div class="btn-group">
      <ul class="navbar-nav">
        <li class="ms-3"><%= link_to 'Users', users_path, class: 'nav-link' %></li>
      </ul>
      <button type="button" class="btn btn-dark dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><%= current_user.name %></button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li class="dropdown-item"><%= link_to 'My profile', user_path(current_user), class: 'nav-link' %></li>
        <li class="dropdown-divider"></li>
        <li class="dropdown-item">Logout</li>
      </ul>
    </div>
  <% else %>
    <ul class="navbar-nav">
      <li class="nav-item"><%= link_to 'Signup', signup_path, class: 'nav-link' %></li>
      <li class="nav-item"><%= link_to 'Login', login_path, class: 'nav-link' %></li>
    </ul>
  <% end %>
</div>

<%= render 'tasks', users: @tasks %>

<% if users.any? %>
  <ul class="list-unstyled">
    <% users.each do |user| %>
      <li class="mb-3 d-flex">
        <img class="rounded me-2" src="<%= gravatar_url(user, { size: 64 }) %>" alt="">
        <div>
          <div>
            <%= user.name %>
          </div>
          <div>
            <p><%= link_to 'View profile', user_path(user), class: "text-decoration-none" %></p>
          </div>
        </div>
      </li>
    <% end %>
  </ul>
  <%== pagy_bootstrap_nav(@pagy) %>
<% end %>

<% if logged_in? %>
  <div class="row">
    <aside class="col-sm-4">
      <%= form_with(model: @micropost) do |f| %>
        <div class="mb-3">
          <%= f.text_area :content, class: 'form-control', rows: 5 %>
        </div>
        <%= f.submit 'Post', class: 'btn btn-primary w-100' %>
      <% end %>
    </aside>
    <div class="col-sm-8">
      <%= render 'tasks/tasks', tasks: @tasks %>
    </div>
  </div>
<% else %>
  <div class="bg-secondary p-3 p-sm-5 my-4 rounded">
    <div class="text-center text-white">
      <h1>Welcome to the tasklist</h1>
      <%= link_to 'Sign up now!', signup_path, class: 'btn btn-lg btn-primary' %>
    </div>
  </div>
<% end %>
